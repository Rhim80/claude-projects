# Gmail Classifier 워크플로우 분석

> AI 기반 11개 카테고리 자동 분류 → Gmail 라벨링 → Telegram 인터랙티브 요약 알림

## 📋 워크플로우 개요

### 기본 정보
- **파일명**: `gmail-classifier.json`
- **실행 주기**: 분 단위 폴링 (everyX minutes)
- **주요 기능**: Gmail 자동 분류 → 라벨링 → AI 요약 → Telegram 알림 → 인터랙티브 처리

### 분류 시스템
**11개 정교한 카테고리 분류**:
1. **🟡 개인 메일** - 가족, 친구 등 사적 연락
2. **🟡 개인 업무 (교육/인터뷰/이벤트)** - CEO 개인 사업 기회
3. **⚫ 광고** - 마케팅, 프로모션 메일
4. **🔴 세무 회계** - 노무법인, 세무서, 회계 관련
5. **🔴 업무 관리** - 매장 운영, 고객 서비스, 공급업체
6. **🔴 인사 급여** - 직원 관리, 4대보험, 노무
7. **🔴 채용 및 기타** - 바리스타, 로스터 채용 관련
8. **🔵 인보이스** - 청구서, 세금계산서, 결제 요청
9. **🟢 AI 기술** - AI, 자동화, n8n, GPTers 등
10. **🟢 인사이트** - 비즈니스 전략, 시장 분석
11. **🟢 업계정보** - 카페, F&B 업계 뉴스

## 🔄 워크플로우 구조

### Phase 1: 이메일 감지 및 상세 정보 추출
```
Gmail Trigger (INBOX 모니터링)
         ↓
Get Message Details
├── 발신자, 제목, 본문 추출
├── 메시지 ID 확보
└── HTML/Text 내용 파싱
```

### Phase 2: AI 기반 분류 및 라벨링
```
AI Email Classifier (GPT-4o-mini)
├── 15년차 F&B 대표 페르소나 적용
├── 11개 카테고리 정교 분류
├── 특별 분류 규칙 7개 적용
└── 발신자, 키워드, 내용 종합 분석
         ↓
Parse Classification (Gmail 라벨 매핑)
├── 카테고리 → Gmail Label ID 변환
├── 중요도 판별 (6개 중요 카테고리)
└── 분류 결과 정리
         ↓
Add Gmail Label (자동 라벨링)
```

### Phase 3: AI 요약 및 Telegram 알림
```
AI Email Summarizer (Gemini 2.5 Pro)
├── 카테고리별 맞춤 요약 가이드
├── [제목], [카테고리], [요약] 구조화
├── 핵심 정보만 간결하게 추출
└── 개인정보/링크/푸터 제거
         ↓
Send Telegram Alert (인터랙티브)
├── 분류 결과 + 요약 전송
├── 📥 보관, 🗑️ 삭제, ⭐ 별표 버튼
└── 실시간 이메일 관리 가능
```

### Phase 4: 인터랙티브 처리
```
Telegram Callback 처리
         ↓
Parse Callback Data (액션 파싱)
         ↓
Action Switch (3가지 분기)
├── Archive Mail (INBOX 라벨 제거)
├── Delete Mail (영구 삭제)
└── Star Mail (별표 추가)
```

## 🧠 AI 분류 시스템 분석

### 1. AI Email Classifier (GPT-4o-mini)
**페르소나 설정**:
```
15년차 F&B 브랜드 대표이자 AI 강의 전문가
- 이미커피 & 이미양과자 대표 (15년 운영)
- AI 실무 활용 전문가 (n8n, Notion, Claude 자동화)
- 기업 강의 및 컨설팅 (소상공인, 자영업자 대상)
- 작가 (출간 경험), 트레바리 리더
```

**특별 분류 규칙 (우선순위)**:
1. **LongBlack/시티호퍼스** → 무조건 "인사이트"
2. **GPTers** → 무조건 "AI 기술"
3. **노무법인/세무서** → 무조건 "세무 회계"
4. **기업 강의/교육 요청** → "개인 업무"
5. **매장 운영 관련** → "업무 관리"
6. **명확한 광고성** → "광고"
7. **위 조건 해당 없음** → 내용 기반 분류

### 2. Gmail 라벨 매핑 시스템
```javascript
const categoryMapping = {
  '개인 메일': 'Label_1',
  '개인 업무 (교육 / 인터뷰 / 이벤트)': 'Label_1959499669462627962',
  '광고': 'Label_2664386232547169382',
  '세무 회계': 'Label_5346007232886454131',
  '업무 관리': 'Label_7564681703374459659',
  '인사 급여': 'Label_7989676787127045663',
  '채용 및 기타': 'Label_2729306689238858667',
  '인보이스': 'Label_2551575746782135007',
  'AI 기술': 'Label_7861502927282720092',
  '인사이트': 'Label_6365891902333944865',
  '업계정보': 'Label_3912834597189393784'
};
```

**중요 카테고리 (Telegram 알림 우선)**:
- Label_1959499669462627962 (개인 업무)
- Label_7564681703374459659 (업무 관리)  
- Label_2551575746782135007 (인보이스)
- Label_7861502927282720092 (AI 기술)
- Label_6365891902333944865 (인사이트)
- Label_5346007232886454131 (세무 회계)

### 3. AI Email Summarizer (Gemini 2.5 Pro)
**카테고리별 맞춤 요약**:
- **개인 업무**: 요청 내용, 일정, 보상/조건, 참석자 수
- **업무 관리**: 긴급도, 처리 방법, 담당자, 기한
- **인보이스**: 금액, 기한, 지불 방법, 항목
- **AI 기술**: 새로운 기능, 활용 방안, 업데이트 내용
- **인사이트**: 핵심 인사이트, 시사점, 액션 아이템
- **세무 회계**: 처리 기한, 필요 서류, 담당자 연락처

**요약 품질 관리**:
- URL, 개인정보, 링크 자동 제거
- 광고/푸터/수신거부 등 부가 정보 제거
- [제목], [카테고리], [요약] 구조화된 형식
- 최대 3문단 이내 간결한 요약

## 📊 Claude Code 연동 개선 계획

### 현재 시스템의 강점
1. **정교한 11개 카테고리 분류**
2. **실제 비즈니스 맥락 반영** (15년 F&B 경험 페르소나)
3. **특별 분류 규칙** (발신자 기반 우선순위)
4. **인터랙티브 처리** (Telegram 3가지 액션)
5. **2단계 AI 시스템** (분류 + 요약 전문화)

### 개선 포인트

#### 1단계: ai-business-architect 에이전트 연동
```bash
# 기존: GPT-4o-mini 단독 분류
Gmail → GPT-4o-mini → 11개 카테고리 분류

# 개선: ai-business-architect 우선 분석
Gmail → ai-business-architect → 비즈니스 중요도 분석 → 기존 분류 시스템
```

**기대 효과**:
- 비즈니스 우선순위 자동 판별
- 긴급성/중요성 매트릭스 적용
- 더 정교한 "개인 업무" vs "업무 관리" 구분

#### 2단계: 분류 정확도 향상
```bash
# 현재: 규칙 기반 + GPT 분류
특별 분류 규칙 (7개) → GPT 분류

# 개선: AI 기반 맥락 이해
ai-business-architect → 발신자 의도 분석 → 맥락 기반 분류
```

#### 3단계: 액션 아이템 자동 추출
```bash
# 기존: 단순 요약만 제공
Gemini 2.5 Pro → [제목] + [요약]

# 개선: 액션 아이템 자동 생성
ai-business-architect → 액션 아이템 추출 → TODO 자동 생성
```

## 🛠 기술적 세부사항

### 핵심 노드 분석

#### 1. Gmail Trigger
- **유형**: `n8n-nodes-base.gmailTrigger`
- **모니터링**: INBOX 라벨만 감시
- **주기**: 분 단위 실시간 폴링

#### 2. AI Email Classifier
- **모델**: GPT-4o-mini (비용 효율성)
- **프롬프트**: 15년차 F&B 대표 페르소나
- **출력**: 구조화된 분류 결과

#### 3. Parse Classification
- **기능**: 복잡한 JavaScript 로직
- **매핑**: 카테고리명 → Gmail Label ID
- **중요도**: 6개 중요 카테고리 판별

#### 4. AI Email Summarizer  
- **모델**: Gemini 2.5 Pro (요약 품질 우선)
- **카테고리별**: 맞춤형 요약 가이드
- **필터링**: 개인정보/광고 자동 제거

#### 5. Telegram Interactive System
- **실시간 알림**: 분류 결과 + 요약
- **3가지 액션**: 보관, 삭제, 별표
- **Callback 처리**: 즉시 Gmail 조작

### 에러 처리 및 보안

#### 데이터 보안
- **Gmail OAuth2**: 안전한 인증 시스템
- **Telegram Bot**: 개인 채널 전용
- **개인정보 보호**: 요약에서 연락처/링크 자동 제거

#### 에러 복구
```javascript
// Parse Classification의 에러 처리
try {
  // 정상 분류 로직
} catch (error) {
  return {
    json: {
      classification: '기타',
      labelName: 'Label_2873843655671434004', // 기본 라벨
      isImportant: false
    }
  };
}
```

## 📈 성과 지표 및 최적화

### 현재 성과 (추정)
- **분류 정확도**: 85-90% (특별 규칙 + GPT 조합)
- **처리 속도**: 이메일 1개당 약 10-15초
- **사용자 만족도**: 인터랙티브 버튼 활용률 기반
- **업무 효율성**: 수동 분류 시간 90% 단축

### Claude Code 연동 후 목표
- **분류 정확도**: 95% 이상 (`ai-business-architect` 맥락 분석)
- **액션 아이템**: 자동 TODO 생성으로 실행력 향상
- **비즈니스 인사이트**: 단순 분류를 넘어선 전략적 알림
- **통합 워크플로우**: 다른 자동화 시스템과 연계

## 🚀 향후 개발 방향

### 즉시 적용 가능 (1주)
1. `ai-business-architect` 에이전트로 중요도 분석 테스트
2. 현재 GPT-4o-mini와 성능 비교
3. 특정 카테고리(개인 업무, 업무 관리)에서 우선 적용

### 중기 개발 (1개월)
1. 액션 아이템 자동 추출 시스템
2. 다른 워크플로우와 연계 (프로젝트 관리, 급여 처리)
3. 비즈니스 대시보드 연동

### 장기 비전 (3개월)
1. 완전 자동화된 이메일 응답 시스템
2. AI 기반 우선순위 스케줄링
3. 비즈니스 인사이트 자동 생성

---

*이 워크플로우는 현재 IMI WORK의 핵심 생산성 도구로, 하루 평균 50-100개의 이메일을 11개 카테고리로 자동 분류하고 중요한 내용만 Telegram으로 실시간 알림하여 업무 효율성을 극대화하고 있습니다.*

## Related Notes
- [[learning-roadmap]] - 높은 연관성
- [[personal-tone-version]] - 높은 연관성
- [[final-seo-version]] - 높은 연관성
- [[system-vs-tool-master]] - 높은 연관성
- [[menu-development-hub]] - 높은 연관성
- [[pkm-sustainability]] - 높은 연관성
- [[education-hub]] - 높은 연관성
