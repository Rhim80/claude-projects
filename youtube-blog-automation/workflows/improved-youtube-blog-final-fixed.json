{
  "name": "YouTube Blog Complete Final (Improved)",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "youtube-blog-automation",
        "responseMode": "responseNode",
        "options": {
          "noResponseBody": false,
          "rawBody": false
        }
      },
      "id": "webhook-trigger-stable",
      "name": "Webhook Trigger (Stable)",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [16, 304],
      "webhookId": "stable-youtube-blog-webhook"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.body.pageId }}",
          "mode": "id"
        }
      },
      "id": "get-video-info-safe",
      "name": "Get Video Info from Notion (Safe)",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [240, 304],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion account"
        }
      },
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetween": 2000
    },
    {
      "parameters": {
        "jsCode": "// Enhanced YouTube ì •ë³´ ì¶”ì¶œ with error handling\nconst items = $input.all();\nconst results = [];\n\nfor (const item of items) {\n  try {\n    let youtubeUrl = '';\n    let title = 'ì œëª© ì—†ìŒ';\n    let channelName = 'ì±„ë„ëª… ì—†ìŒ';\n\n    // YouTube URL ì¶”ì¶œ (ë‹¤ì¤‘ ê²½ë¡œ ì§€ì›)\n    if (item.json.properties?.URL?.url) {\n      youtubeUrl = item.json.properties.URL.url;\n    } else if (item.json.properties?.url?.url) {\n      youtubeUrl = item.json.properties.url.url;\n    } else if (item.json.property_url) {\n      youtubeUrl = item.json.property_url;\n    }\n\n    if (!youtubeUrl) {\n      throw new Error('YouTube URLì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n    }\n\n    // ì œëª© ì¶”ì¶œ\n    if (item.json.properties?.ì œëª©?.title?.[0]?.plain_text) {\n      title = item.json.properties.ì œëª©.title[0].plain_text;\n    } else if (item.json.property_) {\n      title = item.json.property_;\n    } else if (item.json.name) {\n      title = item.json.name;\n    }\n\n    // ì±„ë„ëª… ì¶”ì¶œ  \n    if (item.json.properties?.ì±„ë„ëª…?.rich_text?.[0]?.plain_text) {\n      channelName = item.json.properties.ì±„ë„ëª….rich_text[0].plain_text;\n    } else if (item.json.property_rss) {\n      channelName = item.json.property_rss;\n    }\n\n    // YouTube video ID ì¶”ì¶œ\n    let videoId = '';\n    const match = youtubeUrl.match(/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\n?#]+)/);\n    if (match && match[1]) {\n      videoId = match[1];\n    } else {\n      throw new Error('ìœ íš¨í•œ YouTube video IDë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n    }\n\n    results.push({\n      json: {\n        videoId: videoId,\n        youtubeUrl: youtubeUrl,\n        title: title,\n        channelName: channelName,\n        success: true\n      }\n    });\n\n  } catch (error) {\n    console.error('YouTube ì •ë³´ ì¶”ì¶œ ì˜¤ë¥˜:', error.message);\n    results.push({\n      json: {\n        videoId: null,\n        youtubeUrl: null,\n        title: 'ì˜¤ë¥˜: ' + error.message,\n        channelName: 'ì¶”ì¶œ ì‹¤íŒ¨',\n        success: false,\n        error: error.message\n      }\n    });\n  }\n}\n\nreturn results;"
      },
      "id": "extract-youtube-info-safe",
      "name": "Extract YouTube Info (Safe)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [464, 304]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.json.success }}",
              "operation": "equal",
              "value2": "true"
            }
          ]
        }
      },
      "id": "check-extraction-success",
      "name": "Check Extraction Success",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [688, 304]
    },
    {
      "parameters": {
        "youtubeId": "={{ $json.json.videoId }}",
        "preferCapLang": "ko"
      },
      "id": "get-youtube-transcript-safe",
      "name": "Get YouTube Transcript (Safe)",
      "type": "n8n-nodes-bandi-youtube-transcript.youtubeTranscriptNode",
      "typeVersion": 1,
      "position": [912, 240],
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetween": 3000
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {
          "maxOutputTokens": 4000,
          "temperature": 0.6
        }
      },
      "id": "gemini-model-stable",
      "name": "Gemini for Article (Stable)",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [1200, 448],
      "credentials": {
        "googlePalmApi": {
          "id": "SO4eLSfcE2Z5kkss",
          "name": "hovoo Google Gemini Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "ë‹¹ì‹ ì€ ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ hovooì…ë‹ˆë‹¤.\n\n15ë…„ê°„ ì¹´í˜ 4ê°œ ë§¤ì¥ì„ ìš´ì˜í•˜ë©° F&B ë¸Œëœë”© ì „ë¬¸ê°€ë¡œ í™œë™í–ˆìŠµë‹ˆë‹¤.\në™ì‹œì— AI ìë™í™” ì „ë¬¸ê°€ë¡œì„œ GPTers ì»¤ë®¤ë‹ˆí‹°ì—ì„œ 'AI ê°ì„± ë¸Œëœë”© ì‹œìŠ¤í…œ' ìŠ¤í„°ë””ë¥¼ ìš´ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\nYouTube ì˜ìƒ ìë§‰ì„ ë°”íƒ•ìœ¼ë¡œ ë‹¹ì‹ ì˜ ê²½í—˜ê³¼ í†µì°°ì´ ë‹´ê¸´ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”.\n\n[ì˜ìƒ ì •ë³´]\nì œëª©: {{ $('Extract YouTube Info (Safe)').first().json.json.title }}\nì±„ë„: {{ $('Extract YouTube Info (Safe)').first().json.json.channelName }}\nURL: {{ $('Extract YouTube Info (Safe)').first().json.json.youtubeUrl }}\nVideo ID: {{ $('Extract YouTube Info (Safe)').first().json.json.videoId }}\n\n[ìë§‰ ì „ë¬¸]\n{{ $json.transcript }}\n\n[ë‹¹ì‹ ì˜ ë°°ê²½]\n- ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ, 15ë…„ F&B ìš´ì˜ ê²½í—˜\n- ì¹´í˜ 4ê°œ ë§¤ì¥ + ë² ì´ì»¤ë¦¬ ìš´ì˜ ì¤‘\n- AI ìë™í™” ì „ë¬¸ê°€ (n8n ì›Œí¬í”Œë¡œìš° 7ê°œ ìš´ì˜)\n- GPTers ìŠ¤í„°ë””ì¥, \"AI ê°ì„± ë¸Œëœë”© ì‹œìŠ¤í…œ\" ìš´ì˜\n- ìì˜ì—…ì ëŒ€ìƒ AI êµìœ¡ ê°•ì˜\n- ë„ë©”ì¸: blog.imiwork.com\n\n[ì‘ì„± ìŠ¤íƒ€ì¼]\n1. ì‹¤ë¬´ ê²½í—˜ ê¸°ë°˜ì˜ êµ¬ì²´ì  í†µì°°\n2. ì˜¤í”„ë¼ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ Ã— AI ìœµí•© ê´€ì \n3. ìì˜ì—…ì/ì†Œìƒê³µì¸ì„ ìœ„í•œ ì‹¤ìš©ì  ì¡°ì–¸\n4. 15ë…„ ì¹´í˜ ìš´ì˜ ê²½í—˜ì—ì„œ ë‚˜ì˜¤ëŠ” ê¹Šì´\n5. ì¹œê·¼í•˜ì§€ë§Œ ì „ë¬¸ì ì¸ ì–´íˆ¬\n6. ë§ˆí¬ë‹¤ìš´ í˜•ì‹, H1 ì œëª© í•˜ë‚˜, H2/H3 ì†Œì œëª© êµ¬ì¡°í™”\n7. ìµœì†Œ 2500ì ì´ìƒì˜ ì™„ì „í•œ ê¸€\n\n[ê¸€ êµ¬ì¡°]\n- ë„ì…: \"15ë…„ ì¹´í˜ë¥¼ ìš´ì˜í•˜ë©° ëŠë‚€...\" ì‹ìœ¼ë¡œ ê²½í—˜ ê¸°ë°˜ ì‹œì‘\n- ë³¸ë¬¸: ì˜ìƒ ë‚´ìš© + ë³¸ì¸ ê²½í—˜ ìœµí•©\n- ì‹¤ì „ íŒ: F&B/AI ê´€ì ì—ì„œì˜ êµ¬ì²´ì  ì‹¤í–‰ë²•\n- ê²°ë¡ : ë…ìì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì„±ì¥ì„ ìœ„í•œ í–‰ë™ ìœ ë„\n\nì˜ìƒ ë‚´ìš©ì„ ë‹¨ìˆœ ìš”ì•½í•˜ì§€ ë§ê³ , ë‹¹ì‹ ì˜ 15ë…„ ê²½í—˜ê³¼ AI ì „ë¬¸ì„±ìœ¼ë¡œ ì¬í•´ì„í•´ì„œ ë…ìì—ê²Œ ê°€ì¹˜ ìˆëŠ” í†µì°°ì„ ì œê³µí•˜ëŠ” ì™„ì „í•œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”.",
        "batching": {}
      },
      "id": "create-blog-article-safe",
      "name": "Create Blog Article (Safe)",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [1120, 240],
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetween": 5000
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{\n  \"success\": true,\n  \"message\": \"YouTube ë¸”ë¡œê·¸ ìë™í™”ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\",\n  \"data\": {\n    \"videoId\": \"{{ $('Extract YouTube Info (Safe)').first().json.json.videoId }}\",\n    \"contentLength\": {{ $('Create Blog Article (Safe)').item.json.text.length }},\n    \"processedAt\": \"{{ new Date().toISOString() }}\",\n    \"webhookUrl\": \"https://n8n.imiwork.com/webhook/youtube-blog-automation\"\n  },\n  \"meta\": {\n    \"version\": \"2.0\",\n    \"stable\": true\n  }\n}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "Content-Type": "application/json",
            "X-Workflow": "youtube-blog-automation",
            "X-Version": "stable-2.0"
          }
        }
      },
      "id": "webhook-response-stable",
      "name": "Stable Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [1344, 240]
    },
    {
      "parameters": {
        "chatId": "={{ $json.body.chatId || '7830356405' }}",
        "text": "ğŸš¨ **YouTube ë¸”ë¡œê·¸ ìë™í™” ì˜¤ë¥˜ ë°œìƒ**\n\nâŒ **ì˜¤ë¥˜ ë‹¨ê³„**: {{ $json.errorStep || 'ì•Œ ìˆ˜ ì—†ìŒ' }}\nğŸ” **ì˜¤ë¥˜ ë‚´ìš©**: {{ $json.error || 'ìƒì„¸ ì •ë³´ ì—†ìŒ' }}\nğŸ“ **í˜ì´ì§€ ID**: {{ $json.body.pageId || 'N/A' }}\nğŸ¬ **ë¹„ë””ì˜¤ ID**: {{ $json.body.videoId || 'N/A' }}\n\nâ° **ë°œìƒ ì‹œê°„**: {{ new Date().toLocaleString('ko-KR') }}\n\nğŸ”§ **ì¡°ì¹˜ ì‚¬í•­**: ê´€ë¦¬ìê°€ í™•ì¸ ì¤‘ì…ë‹ˆë‹¤.\n\n---\n*ì´ë¯¸ì»¤í”¼ AI ìë™í™” ì‹œìŠ¤í…œ | Error Handler*",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "send-error-notification",
      "name": "Send Error Notification",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [912, 496],
      "credentials": {
        "telegramApi": {
          "id": "hIo5i77YKdu9Rs8g",
          "name": "youtube imi Telegram account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{\n  \"success\": false,\n  \"message\": \"YouTube ë¸”ë¡œê·¸ ìë™í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\",\n  \"error\": {\n    \"step\": \"{{ $json.errorStep }}\",\n    \"message\": \"{{ $json.error }}\",\n    \"timestamp\": \"{{ new Date().toISOString() }}\"\n  },\n  \"data\": {\n    \"pageId\": \"{{ $json.body.pageId }}\",\n    \"videoId\": \"{{ $json.body.videoId }}\"\n  }\n}",
        "options": {
          "responseCode": 500,
          "responseHeaders": {
            "Content-Type": "application/json",
            "X-Workflow": "youtube-blog-automation",
            "X-Error": "true"
          }
        }
      },
      "id": "error-webhook-response",
      "name": "Error Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [1136, 496]
    }
  ],
  "connections": {
    "Webhook Trigger (Stable)": {
      "main": [
        [
          {
            "node": "Get Video Info from Notion (Safe)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Video Info from Notion (Safe)": {
      "main": [
        [
          {
            "node": "Extract YouTube Info (Safe)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract YouTube Info (Safe)": {
      "main": [
        [
          {
            "node": "Check Extraction Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Extraction Success": {
      "main": [
        [
          {
            "node": "Get YouTube Transcript (Safe)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Error Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get YouTube Transcript (Safe)": {
      "main": [
        [
          {
            "node": "Create Blog Article (Safe)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini for Article (Stable)": {
      "ai_languageModel": [
        [
          {
            "node": "Create Blog Article (Safe)",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Create Blog Article (Safe)": {
      "main": [
        [
          {
            "node": "Stable Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Error Notification": {
      "main": [
        [
          {
            "node": "Error Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "stable-youtube-blog-automation",
    "version": "2.0.0",
    "description": "ê°œì„ ëœ ì•ˆì •ì„±ê³¼ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ê°–ì¶˜ YouTube ë¸”ë¡œê·¸ ìë™í™” ì›Œí¬í”Œë¡œìš°"
  }
}