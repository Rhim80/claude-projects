{
  "name": "YouTube to Blog Final - ì´ë¯¸ì»¤í”¼",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "youtube-to-blog-final",
        "responseMode": "responseNode"
      },
      "onError": "continueRegularOutput",
      "id": "webhook-trigger",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [240, 300],
      "webhookId": "youtube-blog-webhook"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.pageId }}",
          "mode": "expression"
        }
      },
      "id": "get-notion-page",
      "name": "Notion í˜ì´ì§€ ì¡°íšŒ",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [460, 300],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion API"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// YouTube URLì—ì„œ video ID ì¶”ì¶œ ë° ìë§‰ URL ìƒì„±\nconst items = $input.all();\nconst results = [];\n\nfor (const item of items) {\n  try {\n    // Notion í˜ì´ì§€ì—ì„œ YouTube URL ì¶”ì¶œ (properties.URL ë˜ëŠ” properties.url ë“±ì—ì„œ)\n    let youtubeUrl = '';\n    \n    // ì—¬ëŸ¬ ê°€ëŠ¥í•œ í•„ë“œëª… í™•ì¸\n    const properties = item.json.properties;\n    if (properties.URL && properties.URL.url) {\n      youtubeUrl = properties.URL.url;\n    } else if (properties.url && properties.url.url) {\n      youtubeUrl = properties.url.url;\n    } else if (properties['YouTube URL'] && properties['YouTube URL'].url) {\n      youtubeUrl = properties['YouTube URL'].url;\n    } else if (properties.ë§í¬ && properties.ë§í¬.url) {\n      youtubeUrl = properties.ë§í¬.url;\n    }\n    \n    if (!youtubeUrl) {\n      throw new Error('YouTube URLì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n    }\n    \n    // YouTube video ID ì¶”ì¶œ\n    let videoId = '';\n    const urlPatterns = [\n      /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\n?#]+)/,\n      /youtube\\.com\\/embed\\/([^&\\n?#]+)/,\n      /youtube\\.com\\/v\\/([^&\\n?#]+)/\n    ];\n    \n    for (const pattern of urlPatterns) {\n      const match = youtubeUrl.match(pattern);\n      if (match) {\n        videoId = match[1];\n        break;\n      }\n    }\n    \n    if (!videoId) {\n      throw new Error('ìœ íš¨í•œ YouTube video IDë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n    }\n    \n    // ìë§‰ URL ìƒì„± (YouTube Transcript API ë°©ì‹)\n    const transcriptUrl = `https://www.youtube.com/api/timedtext?lang=ko&v=${videoId}&fmt=json3`;\n    \n    results.push({\n      ...item.json,\n      videoId: videoId,\n      youtubeUrl: youtubeUrl,\n      transcriptUrl: transcriptUrl,\n      title: properties.ì œëª©?.title?.[0]?.plain_text || properties.Name?.title?.[0]?.plain_text || 'ì œëª© ì—†ìŒ'\n    });\n  } catch (error) {\n    // ì—ëŸ¬ ë°œìƒì‹œì—ë„ ë°°ì—´ ë°˜í™˜\n    results.push({\n      ...item.json,\n      error: error.message,\n      videoId: null,\n      youtubeUrl: null,\n      transcriptUrl: null\n    });\n  }\n}\n\nreturn results;"
        }
      },
      "id": "extract-youtube-info",
      "name": "YouTube ì •ë³´ ì¶”ì¶œ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "url": "={{ $json.transcriptUrl }}",
        "options": {
          "timeout": 10000
        }
      },
      "id": "fetch-transcript",
      "name": "YouTube ìë§‰ ì¶”ì¶œ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [900, 300],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// YouTube ìë§‰ ë°ì´í„° ì „ì²˜ë¦¬\nconst items = $input.all();\nconst results = [];\n\nfor (const item of items) {\n  try {\n    let transcriptText = '';\n    \n    if (item.json.events && Array.isArray(item.json.events)) {\n      // YouTube API JSON3 í˜•ì‹ ì²˜ë¦¬\n      transcriptText = item.json.events\n        .filter(event => event.segs && event.segs.length > 0)\n        .map(event => \n          event.segs\n            .map(seg => seg.utf8 || '')\n            .join('')\n        )\n        .join(' ')\n        .replace(/\\s+/g, ' ')\n        .trim();\n    } else if (typeof item.json === 'string') {\n      // ë¬¸ìì—´ í˜•íƒœì˜ ìë§‰ ì²˜ë¦¬\n      transcriptText = item.json;\n    } else {\n      // ë‹¤ë¥¸ í˜•ì‹ ì‹œë„\n      transcriptText = JSON.stringify(item.json);\n    }\n    \n    // ìë§‰ ì •ë¦¬\n    transcriptText = transcriptText\n      .replace(/\\[.*?\\]/g, '') // ëŒ€ê´„í˜¸ ì œê±°\n      .replace(/\\(.*?\\)/g, '') // ì†Œê´„í˜¸ ì œê±°\n      .replace(/\\s+/g, ' ')    // ë‹¤ì¤‘ ê³µë°± ì •ë¦¬\n      .trim();\n    \n    if (transcriptText.length < 50) {\n      throw new Error('ìë§‰ì´ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì–¸ì–´ë‚˜ ìˆ˜ë™ ìë§‰ì„ í™•ì¸í•´ë³´ì„¸ìš”.');\n    }\n    \n    results.push({\n      ...item.json,\n      transcript: transcriptText,\n      transcriptLength: transcriptText.length,\n      processed: true\n    });\n  } catch (error) {\n    results.push({\n      ...item.json,\n      transcript: '',\n      error: error.message,\n      processed: false\n    });\n  }\n}\n\nreturn results;"
      },
      "onError": "continueRegularOutput",
      "id": "process-transcript",
      "name": "ìë§‰ ì „ì²˜ë¦¬",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1120, 300]
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "message",
        "modelId": {
          "__rl": true,
          "value": "gemini-1.5-pro-latest",
          "mode": "list"
        },
        "prompt": "=# ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ hovooì˜ YouTube ë¸”ë¡œê·¸ ê¸€ ì‘ì„±\n\në‹¹ì‹ ì€ 15ë…„ê°„ ì¹´í˜ë¥¼ ìš´ì˜í•˜ë©° F&B ë¸Œëœë”© ì „ë¬¸ê°€ë¡œ í™œë™í•´ì˜¨ 'ì´ë¯¸ì»¤í”¼' ëŒ€í‘œ hovooì…ë‹ˆë‹¤.\ní˜„ì¬ AI ìë™í™” ì „ë¬¸ê°€ë¡œë„ í™œë™í•˜ë©°, GPTers ì»¤ë®¤ë‹ˆí‹°ì—ì„œ 'AI ê°ì„± ë¸Œëœë”© ì‹œìŠ¤í…œ' ìŠ¤í„°ë””ë¥¼ ìš´ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\n## ë‹¹ì‹ ì˜ ì •ì²´ì„±\n- 15ë…„ì°¨ F&B ë¸Œëœë”© ë° ìš´ì˜ ì „ë¬¸ê°€\n- ì¹´í˜ 4ê°œ ë§¤ì¥ ìš´ì˜ (imi coffee)\n- ì´ë¯¸ì–‘ê³¼ì ë² ì´ì»¤ë¦¬ ìš´ì˜\n- ë¡œìŠ¤íŒ… ì‚¬ì—… (ì‹í’ˆì œì¡°ê°€ê³µì—… ë³´ìœ )\n- AI êµìœ¡ ì‚¬ì—… (ìì˜ì—…ì/ì†Œìƒê³µì¸ ëŒ€ìƒ)\n- GPTers ìŠ¤í„°ë””ì¥ (í•œêµ­ ìµœëŒ€ AI ì»¤ë®¤ë‹ˆí‹°)\n- n8n ìë™í™” ì „ë¬¸ê°€ (5ê°œ ì›Œí¬í”Œë¡œìš° ìš´ì˜ ì¤‘)\n\n## ë¸”ë¡œê·¸ ê¸€ ì‘ì„± ê°€ì´ë“œë¼ì¸\n1. **ê²½í—˜ ì¤‘ì‹¬**: 15ë…„ ì¹´í˜ ìš´ì˜ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ í•œ ì‹¤ë¬´ì  ê´€ì \n2. **AI Ã— ì˜¤í”„ë¼ì¸ ìœµí•©**: AI ê¸°ìˆ ì„ ì˜¤í”„ë¼ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ì— ì ìš©í•˜ëŠ” ê´€ì \n3. **ì‹¤ìš©ì  ì¡°ì–¸**: ì´ë¡ ë³´ë‹¤ëŠ” ì¦‰ì‹œ í™œìš© ê°€ëŠ¥í•œ ì‹¤ë¬´ íŒ\n4. **ê°ì„±ì  ë¸Œëœë”©**: ê¸°ìˆ ì  ë‚´ìš©ë„ ê°ì„±ê³¼ ìŠ¤í† ë¦¬ë¡œ í¬ì¥\n5. **ìì˜ì—…ì ê´€ì **: ì†Œìƒê³µì¸ì´ ì´í•´í•˜ê¸° ì‰¬ìš´ ì–¸ì–´ ì‚¬ìš©\n\n## ê¸€ êµ¬ì¡°\n1. **ë„ì…ë¶€**: ê°œì¸ì  ê²½í—˜ì´ë‚˜ ë§¤ì¥ì—ì„œì˜ ì—í”¼ì†Œë“œë¡œ ì‹œì‘\n2. **í•µì‹¬ ë‚´ìš©**: YouTube ë‚´ìš©ì„ hovooì˜ ê´€ì ìœ¼ë¡œ ì¬í•´ì„\n3. **ì‹¤ë¬´ ì ìš©**: ì¹´í˜/ë² ì´ì»¤ë¦¬ ìš´ì˜ì´ë‚˜ AI í™œìš©ì— ì–´ë–»ê²Œ ì ìš©í•  ìˆ˜ ìˆëŠ”ì§€\n4. **ë§ˆë¬´ë¦¬**: ë…ìì—ê²Œ ì£¼ëŠ” ì‹¤ìš©ì  ì¡°ì–¸ì´ë‚˜ ë‹¤ìŒ ì•¡ì…˜\n\n## ë§íˆ¬ ë° ìŠ¤íƒ€ì¼\n- ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ ë§íˆ¬ (ë°˜ë§ ì‚¬ìš©)\n- ì „ë¬¸ì ì´ì§€ë§Œ ì–´ë µì§€ ì•Šê²Œ\n- ê°œì¸ì  ê²½í—˜ê³¼ ë°ì´í„°ë¥¼ ê· í˜•ìˆê²Œ í™œìš©\n- í˜¸ê¸°ì‹¬ì„ ìê·¹í•˜ëŠ” ì œëª©ê³¼ ì†Œì œëª©\n\n---\n\n**YouTube ì˜ìƒ ì •ë³´:**\nì œëª©: {{ $json.title }}\nURL: {{ $json.youtubeUrl }}\n\n**YouTube ìë§‰ ë‚´ìš©:**\n{{ $json.transcript }}\n\nìœ„ YouTube ì˜ìƒ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ, ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ hovooì˜ ê´€ì ì—ì„œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.\nê¸€ì ìˆ˜ëŠ” 1,500-2,500ì ì •ë„ë¡œ, ì½ê¸° ì‰½ê³  ì‹¤ìš©ì ì¸ ë‚´ìš©ìœ¼ë¡œ êµ¬ì„±í•´ì£¼ì„¸ìš”."
      },
      "id": "generate-blog-content",
      "name": "ë¸”ë¡œê·¸ ê¸€ ìƒì„±",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [1340, 300],
      "credentials": {
        "googleGeminiApi": {
          "id": "SO4eLSfcE2Z5kkss",
          "name": "Gemini API"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "create",
        "databaseId": {
          "__rl": true,
          "value": "251d0f53623d8158b023d994a1e58122",
          "mode": "id"
        },
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "ì œëª©",
              "textValue": "={{ $json.title }} - ì´ë¯¸ì»¤í”¼ ë¸”ë¡œê·¸"
            },
            {
              "key": "ë‚´ìš©",
              "richTextValue": "={{ $json.text }}"
            },
            {
              "key": "ìƒíƒœ",
              "selectValue": "ì‘ì„±ì™„ë£Œ"
            },
            {
              "key": "ì‘ì„±ì¼",
              "dateValue": "={{ $now.toISODate() }}"
            },
            {
              "key": "YouTube URL",
              "urlValue": "={{ $json.youtubeUrl }}"
            }
          ]
        }
      },
      "id": "save-to-notion",
      "name": "Notion ë¸”ë¡œê·¸ ì €ì¥",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [1560, 300],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion API"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "sendMessage",
        "chatId": "7830356405",
        "text": "ğŸ‰ ì´ë¯¸ì»¤í”¼ ë¸”ë¡œê·¸ ìë™í™” ì™„ë£Œ!\n\nğŸ“ ì œëª©: {{ $json.title }}\nğŸ”— YouTube: {{ $json.youtubeUrl }}\nğŸ“Š ìë§‰ ê¸¸ì´: {{ $json.transcriptLength }}ì\nâ° ìƒì„±ì‹œê°„: {{ $now.toDateTime() }}\n\nâœ… Notion ë¸”ë¡œê·¸ DBì— ì €ì¥ ì™„ë£Œ\nğŸ’¡ hovooì˜ 15ë…„ F&B ê²½í—˜ì´ ë‹´ê¸´ ë¸”ë¡œê·¸ ê¸€ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!"
      },
      "id": "send-telegram-notification",
      "name": "Telegram ì•Œë¦¼",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1780, 200],
      "onError": "continueRegularOutput",
      "credentials": {
        "telegramApi": {
          "id": "hIo5i77YKdu9Rs8g",
          "name": "Telegram"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{\n  \"success\": true,\n  \"message\": \"YouTube ë¸”ë¡œê·¸ ìë™í™” ì™„ë£Œ\",\n  \"data\": {\n    \"title\": \"{{ $json.title }}\",\n    \"youtubeUrl\": \"{{ $json.youtubeUrl }}\",\n    \"transcriptLength\": {{ $json.transcriptLength }},\n    \"blogCreated\": true,\n    \"notificationSent\": true,\n    \"timestamp\": \"{{ $now.toDateTime() }}\"\n  }\n}"
      },
      "id": "webhook-response",
      "name": "Webhook ì‘ë‹µ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [1780, 400],
      "onError": "continueRegularOutput"
    }
  ],
  "connections": {
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Notion í˜ì´ì§€ ì¡°íšŒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion í˜ì´ì§€ ì¡°íšŒ": {
      "main": [
        [
          {
            "node": "YouTube ì •ë³´ ì¶”ì¶œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "YouTube ì •ë³´ ì¶”ì¶œ": {
      "main": [
        [
          {
            "node": "YouTube ìë§‰ ì¶”ì¶œ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "YouTube ìë§‰ ì¶”ì¶œ": {
      "main": [
        [
          {
            "node": "ìë§‰ ì „ì²˜ë¦¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ìë§‰ ì „ì²˜ë¦¬": {
      "main": [
        [
          {
            "node": "ë¸”ë¡œê·¸ ê¸€ ìƒì„±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë¸”ë¡œê·¸ ê¸€ ìƒì„±": {
      "main": [
        [
          {
            "node": "Notion ë¸”ë¡œê·¸ ì €ì¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion ë¸”ë¡œê·¸ ì €ì¥": {
      "main": [
        [
          {
            "node": "Telegram ì•Œë¦¼",
            "type": "main",
            "index": 0
          },
          {
            "node": "Webhook ì‘ë‹µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-01-24T12:00:00.000Z",
      "updatedAt": "2025-01-24T12:00:00.000Z",
      "id": "imiwork-automation",
      "name": "ì´ë¯¸ì»¤í”¼ ìë™í™”"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-01-24T12:00:00.000Z",
  "versionId": "1"
}