{
  "name": "YouTube Blog Enhanced Final",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "youtube-blog-enhanced-final",
        "responseMode": "responseNode",
        "options": {
          "noResponseBody": false
        }
      },
      "id": "enhanced-webhook-trigger",
      "name": "Enhanced Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [16, 304],
      "webhookId": "enhanced-webhook-trigger"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced input validation and immediate response\nconst body = $input.first().json.body;\n\n// Validate required fields\nif (!body || !body.pageId || !body.videoId) {\n  return {\n    statusCode: 400,\n    error: 'Missing required fields: pageId and videoId are required',\n    timestamp: new Date().toISOString()\n  };\n}\n\n// Return immediate acknowledgment\nreturn {\n  statusCode: 200,\n  message: 'Blog generation started',\n  workflowId: 'youtube-blog-enhanced-final',\n  requestId: `${body.pageId}-${Date.now()}`,\n  estimatedCompletionTime: '2-3 minutes',\n  status: 'processing',\n  timestamp: new Date().toISOString(),\n  data: {\n    pageId: body.pageId,\n    videoId: body.videoId,\n    triggeredBy: body.triggeredBy || 'unknown',\n    workflowVersion: 'enhanced'\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [240, 192],
      "id": "validate-and-respond",
      "name": "Validate and Respond"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {}
      },
      "id": "immediate-webhook-response",
      "name": "Immediate Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [448, 192]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.statusCode }}",
              "value2": 200
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [656, 304],
      "id": "check-validation-success",
      "name": "Check Validation Success"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $('Enhanced Webhook Trigger').item.json.body.pageId }}",
          "mode": "id"
        }
      },
      "id": "get-notion-data-enhanced",
      "name": "Get Notion Data Enhanced",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [864, 224],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced YouTube info extraction with multiple fallback strategies\nconst notionData = $input.first().json;\nconst originalBody = $('Enhanced Webhook Trigger').item.json.body;\n\n// Enhanced extraction function with comprehensive fallback\nfunction extractYouTubeInfo(data, fallbackVideoId) {\n  const extractors = [\n    // Direct property extractors\n    d => d.property_url,\n    d => d.properties?.URL?.url,\n    d => d.properties?.url?.url,\n    d => d.properties?.ë§í¬?.url,\n    d => d.properties?.[\"ì›ë³¸ ì˜ìƒ\"]?.url,\n    \n    // Search all properties for URL-like values\n    d => {\n      const props = d.properties || {};\n      for (const [key, value] of Object.entries(props)) {\n        if (value?.url && typeof value.url === 'string' && value.url.includes('youtube.com')) {\n          return value.url;\n        }\n      }\n      return null;\n    },\n    \n    // Last resort: construct from video ID\n    d => fallbackVideoId ? `https://www.youtube.com/watch?v=${fallbackVideoId}` : null\n  ];\n\n  for (let i = 0; i < extractors.length; i++) {\n    try {\n      const url = extractors[i](data);\n      if (url && typeof url === 'string') {\n        const videoId = extractVideoId(url);\n        if (videoId) {\n          return {\n            success: true,\n            youtubeUrl: url,\n            videoId: videoId,\n            extractorUsed: i,\n            source: i === extractors.length - 1 ? 'fallback' : 'notion'\n          };\n        }\n      }\n    } catch (error) {\n      console.log(`Extractor ${i} failed:`, error.message);\n    }\n  }\n\n  return {\n    success: false,\n    error: 'No valid YouTube URL found',\n    debugInfo: {\n      availableProperties: Object.keys(data.properties || {}),\n      directProperties: Object.keys(data).filter(k => k.startsWith('property_')),\n      fallbackVideoId: fallbackVideoId\n    }\n  };\n}\n\nfunction extractVideoId(url) {\n  const patterns = [\n    /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\n?#]+)/,\n    /youtube\\.com\\/embed\\/([^&\\n?#]+)/,\n    /youtube\\.com\\/v\\/([^&\\n?#]+)/\n  ];\n  \n  for (const pattern of patterns) {\n    const match = url.match(pattern);\n    if (match && match[1]) {\n      return match[1];\n    }\n  }\n  return null;\n}\n\n// Enhanced title and channel extraction\nfunction extractMetadata(data) {\n  const titleExtractors = [\n    d => d.property_,\n    d => d.name,\n    d => d.properties?.ì œëª©?.title?.[0]?.text?.content,\n    d => d.properties?.Title?.title?.[0]?.text?.content,\n    d => 'ì œëª© ì—†ìŒ'\n  ];\n  \n  const channelExtractors = [\n    d => d.property_rss,\n    d => d.properties?.ì±„ë„ëª…?.rich_text?.[0]?.text?.content,\n    d => d.properties?.[\"RSSì†ŒìŠ¤\"]?.select?.name,\n    d => 'ì±„ë„ëª… ì—†ìŒ'\n  ];\n  \n  let title = 'ì œëª© ì—†ìŒ';\n  let channelName = 'ì±„ë„ëª… ì—†ìŒ';\n  \n  for (const extractor of titleExtractors) {\n    try {\n      const result = extractor(data);\n      if (result && typeof result === 'string' && result !== 'ì œëª© ì—†ìŒ') {\n        title = result;\n        break;\n      }\n    } catch (e) {}\n  }\n  \n  for (const extractor of channelExtractors) {\n    try {\n      const result = extractor(data);\n      if (result && typeof result === 'string' && result !== 'ì±„ë„ëª… ì—†ìŒ') {\n        channelName = result;\n        break;\n      }\n    } catch (e) {}\n  }\n  \n  return { title, channelName };\n}\n\n// Extract transcript if available\nfunction extractTranscript(data) {\n  const transcriptExtractors = [\n    d => d.properties?.ìë§‰ì›ë¬¸?.rich_text?.[0]?.text?.content,\n    d => d.properties?.transcript?.rich_text?.[0]?.text?.content,\n    d => d.properties?.Transcript?.rich_text?.[0]?.text?.content\n  ];\n  \n  for (const extractor of transcriptExtractors) {\n    try {\n      const transcript = extractor(data);\n      if (transcript && transcript.length > 100) {\n        return {\n          hasTranscript: true,\n          transcript: transcript,\n          source: 'cached'\n        };\n      }\n    } catch (e) {}\n  }\n  \n  return {\n    hasTranscript: false,\n    transcript: null,\n    source: 'none'\n  };\n}\n\n// Main execution\ntry {\n  const youtubeInfo = extractYouTubeInfo(notionData, originalBody.videoId);\n  const metadata = extractMetadata(notionData);\n  const transcriptInfo = extractTranscript(notionData);\n  \n  const result = {\n    ...youtubeInfo,\n    ...metadata,\n    ...transcriptInfo,\n    pageId: originalBody.pageId,\n    triggeredBy: originalBody.triggeredBy || 'unknown',\n    timestamp: new Date().toISOString()\n  };\n  \n  return result;\n  \n} catch (error) {\n  return {\n    success: false,\n    error: error.message,\n    stack: error.stack,\n    pageId: originalBody.pageId,\n    videoId: originalBody.videoId,\n    timestamp: new Date().toISOString()\n  };\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1072, 224],\n      "id": "enhanced-extract-info",
      "name": "Enhanced Extract Info"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.success }}",
              "value2": true
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1280, 224],
      "id": "check-extraction-success",
      "name": "Check Extraction Success"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.hasTranscript }}",
              "value2": true
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1488, 144],
      "id": "check-cached-transcript",
      "name": "Check Cached Transcript"
    },
    {
      "parameters": {
        "youtubeId": "={{ $json.videoId }}",
        "preferCapLang": "ko"
      },
      "id": "fetch-missing-transcript",
      "name": "Fetch Missing Transcript",
      "type": "n8n-nodes-bandi-youtube-transcript.youtubeTranscriptNode",
      "typeVersion": 1,
      "position": [1696, 304],
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Merge transcript data and prepare for blog generation\nconst extractedInfo = $('Enhanced Extract Info').item.json;\nconst cachedTranscript = extractedInfo.hasTranscript ? extractedInfo.transcript : null;\nconst fetchedTranscript = $input.first().json?.transcript || null;\n\n// Use cached transcript if available, otherwise use fetched\nconst finalTranscript = cachedTranscript || fetchedTranscript;\n\nif (!finalTranscript || finalTranscript.length < 50) {\n  // Fallback for when no transcript is available\n  return {\n    ...extractedInfo,\n    transcript: `ì œëª© ê¸°ë°˜ ì½˜í…ì¸ : ${extractedInfo.title}\\n\\nì´ ì˜ìƒì— ëŒ€í•œ ìë§‰ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ì–´ ì œëª©ê³¼ ì±„ë„ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•©ë‹ˆë‹¤.`,\n    transcriptSource: 'fallback',\n    transcriptLength: 0,\n    readyForBlogGeneration: true\n  };\n}\n\nreturn {\n  ...extractedInfo,\n  transcript: finalTranscript,\n  transcriptSource: cachedTranscript ? 'cached' : 'fresh',\n  transcriptLength: finalTranscript.length,\n  readyForBlogGeneration: true\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1904, 224],
      "id": "merge-transcript-data",
      "name": "Merge Transcript Data"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "ë‹¹ì‹ ì€ ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ hovooì…ë‹ˆë‹¤.\n\n15ë…„ê°„ ì¹´í˜ 4ê°œ ë§¤ì¥ì„ ìš´ì˜í•˜ë©° F&B ë¸Œëœë”© ì „ë¬¸ê°€ë¡œ í™œë™í–ˆìŠµë‹ˆë‹¤.\në™ì‹œì— AI ìë™í™” ì „ë¬¸ê°€ë¡œì„œ GPTers ì»¤ë®¤ë‹ˆí‹°ì—ì„œ 'AI ê°ì„± ë¸Œëœë”© ì‹œìŠ¤í…œ' ìŠ¤í„°ë””ë¥¼ ìš´ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n\nYouTube ì˜ìƒ ìë§‰ì„ ë°”íƒ•ìœ¼ë¡œ ë‹¹ì‹ ì˜ ê²½í—˜ê³¼ í†µì°°ì´ ë‹´ê¸´ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”.\n\n[ì˜ìƒ ì •ë³´]\nì œëª©: {{ $json.title }}\nì±„ë„: {{ $json.channelName }}\nURL: {{ $json.youtubeUrl }}\nVideo ID: {{ $json.videoId }}\nìë§‰ ì†ŒìŠ¤: {{ $json.transcriptSource }}\n\n[ìë§‰ ì „ë¬¸]\n{{ $json.transcript }}\n\n[ë‹¹ì‹ ì˜ ë°°ê²½]\n- ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ, 15ë…„ F&B ìš´ì˜ ê²½í—˜\n- ì¹´í˜ 4ê°œ ë§¤ì¥ + ë² ì´ì»¤ë¦¬ ìš´ì˜ ì¤‘\n- AI ìë™í™” ì „ë¬¸ê°€ (n8n ì›Œí¬í”Œë¡œìš° 5ê°œ ìš´ì˜)\n- GPTers ìŠ¤í„°ë””ì¥, \"AI ê°ì„± ë¸Œëœë”© ì‹œìŠ¤í…œ\" ìš´ì˜\n- ìì˜ì—…ì ëŒ€ìƒ AI êµìœ¡ ê°•ì˜\n- ë„ë©”ì¸: blog.imiwork.com\n\n[ì‘ì„± ìŠ¤íƒ€ì¼]\n1. ì‹¤ë¬´ ê²½í—˜ ê¸°ë°˜ì˜ êµ¬ì²´ì  í†µì°°\n2. ì˜¤í”„ë¼ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ Ã— AI ìœµí•© ê´€ì \n3. ìì˜ì—…ì/ì†Œìƒê³µì¸ì„ ìœ„í•œ ì‹¤ìš©ì  ì¡°ì–¸\n4. 15ë…„ ì¹´í˜ ìš´ì˜ ê²½í—˜ì—ì„œ ë‚˜ì˜¤ëŠ” ê¹Šì´\n5. ì¹œê·¼í•˜ì§€ë§Œ ì „ë¬¸ì ì¸ ì–´íˆ¬\n6. ë§ˆí¬ë‹¤ìš´ í˜•ì‹, H1 ì œëª© í•˜ë‚˜, H2/H3 ì†Œì œëª© êµ¬ì¡°í™”\n7. ìµœì†Œ 2500ì ì´ìƒì˜ ì™„ì „í•œ ê¸€\n\n[ê¸€ êµ¬ì¡°]\n- ë„ì…: \"15ë…„ ì¹´í˜ë¥¼ ìš´ì˜í•˜ë©° ëŠë‚€...\" ì‹ìœ¼ë¡œ ê²½í—˜ ê¸°ë°˜ ì‹œì‘\n- ë³¸ë¬¸: ì˜ìƒ ë‚´ìš© + ë³¸ì¸ ê²½í—˜ ìœµí•©\n- ì‹¤ì „ íŒ: F&B/AI ê´€ì ì—ì„œì˜ êµ¬ì²´ì  ì‹¤í–‰ë²•\n- ê²°ë¡ : ë…ìì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì„±ì¥ì„ ìœ„í•œ í–‰ë™ ìœ ë„\n\nì¤‘ìš”: ì˜ìƒ ë‚´ìš©ì„ ë‹¨ìˆœ ìš”ì•½í•˜ì§€ ë§ê³ , ë‹¹ì‹ ì˜ 15ë…„ ê²½í—˜ê³¼ AI ì „ë¬¸ì„±ìœ¼ë¡œ ì¬í•´ì„í•´ì„œ ë…ìì—ê²Œ ê°€ì¹˜ ìˆëŠ” í†µì°°ì„ ì œê³µí•˜ëŠ” ì™„ì „í•œ ë¸”ë¡œê·¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”.",
        "batching": {}
      },
      "id": "enhanced-blog-generation",
      "name": "Enhanced Blog Generation",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [2112, 224]
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {
          "maxOutputTokens": 4000,
          "temperature": 0.6
        }
      },
      "id": "gemini-blog-model",
      "name": "Gemini Blog Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [2192, 432],
      "credentials": {
        "googlePalmApi": {
          "id": "SO4eLSfcE2Z5kkss",
          "name": "hovoo Google Gemini Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "# SEO ìµœì í™” ë©”íƒ€ë°ì´í„° ìƒì„± (Enhanced)\n\në‹¤ìŒ ë¸”ë¡œê·¸ ê¸€ì„ ë¶„ì„í•˜ì—¬ SEOì— ìµœì í™”ëœ ë©”íƒ€ë°ì´í„°ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ìƒì„±í•´ ì£¼ì„¸ìš”.\n\n**ì›ë³¸ ë¸”ë¡œê·¸ ê¸€**: {{ $json.text }}\n**ì±„ë„**: {{ $('Merge Transcript Data').item.json.channelName }}\n**ì˜ìƒ ì œëª©**: {{ $('Merge Transcript Data').item.json.title }}\n**ìë§‰ ê¸¸ì´**: {{ $('Merge Transcript Data').item.json.transcriptLength }}ì\n**ìë§‰ ì†ŒìŠ¤**: {{ $('Merge Transcript Data').item.json.transcriptSource }}\n\n## ìƒì„±í•  ë©”íƒ€ë°ì´í„°:\n\n1. **title**: SEO ì¹œí™”ì  ì œëª© (50-60ì, hovoo ë¸Œëœë“œ í¬í•¨)\n2. **meta_description**: ë©”íƒ€ ì„¤ëª… (140-160ì, í´ë¦­ ìœ ë„)\n3. **tags**: ê´€ë ¨ íƒœê·¸ ë°°ì—´ (6-10ê°œ, ë¸Œëœë“œ í‚¤ì›Œë“œ ìš°ì„ )\n4. **slug**: URL ì¹œí™”ì  ìŠ¬ëŸ¬ê·¸ (ì˜ë¬¸, í•˜ì´í”ˆ ì‚¬ìš©, ë‚ ì§œ í¬í•¨)\n5. **excerpt**: ìš”ì•½ë¬¸ (200-250ì, ê¸€ì˜ í•µì‹¬ ë‚´ìš©)\n6. **featured_image_alt**: ëŒ€í‘œ ì´ë¯¸ì§€ alt í…ìŠ¤íŠ¸\n7. **keywords**: íƒ€ê²Ÿ í‚¤ì›Œë“œ ë°°ì—´ (ë¡±í…Œì¼ í‚¤ì›Œë“œ í¬í•¨)\n8. **category**: ê¸€ ì¹´í…Œê³ ë¦¬ (hovoo ë¸”ë¡œê·¸ ë§ì¶¤)\n9. **readingTime**: ì˜ˆìƒ ì½ê¸° ì‹œê°„ (ë¶„)\n10. **contentQuality**: ì½˜í…ì¸  í’ˆì§ˆ ì ìˆ˜ (1-10)\n\n## í‚¤ì›Œë“œ ì „ëµ (ìš°ì„ ìˆœìœ„ë³„):\n- **ë¸Œëœë“œ**: ì´ë¯¸ì»¤í”¼, hovoo, AIìë™í™”\n- **Primary**: ì¹´í˜ ìš´ì˜, n8n ì›Œí¬í”Œë¡œìš°, F&B ë¸Œëœë”©\n- **Secondary**: ìì˜ì—…ì, ì†Œìƒê³µì¸, AI í™œìš©\n- **Long-tail**: êµ¬ì²´ì  ê¸°ëŠ¥/ë°©ë²• ê´€ë ¨ í‚¤ì›Œë“œ\n\n## ìŠ¬ëŸ¬ê·¸ ê·œì¹™:\n- hovoo-[ì£¼ì œ]-[íŠ¹ì§•]-2408 í˜•ì‹\n- ì˜ˆ: hovoo-ai-automation-cafe-branding-2408\n\n## ê³ ë ¤ì‚¬í•­:\n- hovooì˜ ì „ë¬¸ì„± ì˜ì—­ ê°•ì¡°\n- íƒ€ê²Ÿ ë…ì: ìì˜ì—…ì, ì†Œìƒê³µì¸, AI í™œìš© ê´€ì‹¬ì\n- ê²€ìƒ‰ ì˜ë„: ì‹¤ë¬´ ì ìš© ê°€ëŠ¥í•œ ì •ë³´ ì¶”êµ¬\n- ë¸Œëœë“œ ì¼ê´€ì„± ìœ ì§€\n\n**ë°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ ì£¼ì„¸ìš”.**",
        "batching": {}
      },
      "id": "enhanced-seo-optimization",
      "name": "Enhanced SEO Optimization", 
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [2320, 224]
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {
          "maxOutputTokens": 2000,
          "temperature": 0.3
        }
      },
      "id": "gemini-seo-model",
      "name": "Gemini SEO Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [2400, 432],
      "credentials": {
        "googlePalmApi": {
          "id": "SO4eLSfcE2Z5kkss",
          "name": "hovoo Google Gemini Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Enhanced JSON parsing with comprehensive error handling\nconst rawText = $input.first().json.text;\nconst originalData = $('Merge Transcript Data').item.json;\n\nfunction parseEnhancedJSON(text) {\n  let jsonText = text;\n\n  // Extract JSON from various formats\n  if (text.includes('```json')) {\n    const start = text.indexOf('```json') + 7;\n    const end = text.lastIndexOf('```');\n    jsonText = text.substring(start, end).trim();\n  } else if (text.includes('{')) {\n    const start = text.indexOf('{');\n    const end = text.lastIndexOf('}');\n    if (start !== -1 && end !== -1 && end > start) {\n      jsonText = text.substring(start, end + 1);\n    }\n  }\n\n  try {\n    const data = JSON.parse(jsonText);\n    \n    // Enhanced validation and defaults with hovoo branding\n    const result = {\n      title: data.title || `hovooì˜ ${originalData.channelName} ì˜ìƒ ë¶„ì„`,\n      meta_description: data.meta_description || `ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ hovooì˜ 15ë…„ F&B ê²½í—˜ê³¼ AI ì „ë¬¸ì„±ìœ¼ë¡œ í•´ì„í•œ ${originalData.title} ì˜ìƒ ë¶„ì„`,\n      tags: Array.isArray(data.tags) ? data.tags : ['ì´ë¯¸ì»¤í”¼', 'hovoo', 'AIìë™í™”', 'ì¹´í˜ìš´ì˜'],\n      slug: data.slug || generateSlug(originalData.title),\n      excerpt: data.excerpt || data.meta_description || 'ì‹¤ë¬´ ê²½í—˜ ê¸°ë°˜ì˜ ê°€ì¹˜ ìˆëŠ” í†µì°°',\n      featured_image_alt: data.featured_image_alt || `hovoo ì´ë¯¸ì»¤í”¼ ${originalData.channelName} ì˜ìƒ ë¶„ì„`,\n      keywords: Array.isArray(data.keywords) ? data.keywords : ['ì¹´í˜ ìš´ì˜ ë…¸í•˜ìš°', 'AI ìë™í™”', 'hovoo ê²½í—˜', 'ì´ë¯¸ì»¤í”¼ ì‹œìŠ¤í…œ'],\n      category: data.category || 'AI ì‹¤ë¬´ í™œìš©',\n      readingTime: data.readingTime || Math.ceil($('Enhanced Blog Generation').item.json.text.length / 1000),\n      contentQuality: data.contentQuality || 8\n    };\n\n    // Enhanced slug processing\n    result.slug = cleanSlug(result.slug);\n    \n    // Ensure hovoo brand tags are present\n    if (!result.tags.includes('ì´ë¯¸ì»¤í”¼')) {\n      result.tags.unshift('ì´ë¯¸ì»¤í”¼');\n    }\n    if (!result.tags.includes('hovoo')) {\n      result.tags.unshift('hovoo');\n    }\n    \n    // Limit tags to 10\n    result.tags = result.tags.slice(0, 10);\n    \n    // Add processing metadata\n    result.metadata = {\n      processed_at: new Date().toISOString(),\n      source_channel: originalData.channelName,\n      video_id: originalData.videoId,\n      transcript_source: originalData.transcriptSource,\n      transcript_length: originalData.transcriptLength,\n      blog_length: $('Enhanced Blog Generation').item.json.text.length,\n      parsing_success: true\n    };\n    \n    return result;\n\n  } catch (error) {\n    // Comprehensive fallback with hovoo branding\n    return {\n      title: `hovooê°€ ë¶„ì„í•˜ëŠ” ${originalData.channelName} - ${originalData.title}`,\n      meta_description: `ì´ë¯¸ì»¤í”¼ ëŒ€í‘œ hovooì˜ 15ë…„ F&B ê²½í—˜ìœ¼ë¡œ í•´ì„í•œ ${originalData.channelName} ì±„ë„ì˜ ${originalData.title} ì˜ìƒ ë¶„ì„ê³¼ ì‹¤ë¬´ ì ìš© ë°©ì•ˆ`,\n      tags: ['ì´ë¯¸ì»¤í”¼', 'hovoo', 'AIìë™í™”', 'ì¹´í˜ìš´ì˜', 'F&Bë¸Œëœë”©', originalData.channelName.replace(/\\s/g, '')],\n      slug: generateSlug(originalData.title),\n      excerpt: `${originalData.channelName}ì˜ ${originalData.title} ì˜ìƒì„ hovooì˜ 15ë…„ ì¹´í˜ ìš´ì˜ ê²½í—˜ê³¼ AI ì „ë¬¸ì„±ìœ¼ë¡œ ë¶„ì„í•œ ì‹¤ë¬´ í™œìš© ê°€ì´ë“œì…ë‹ˆë‹¤.`,\n      featured_image_alt: `hovoo ì´ë¯¸ì»¤í”¼ ${originalData.channelName} ì˜ìƒ ë¶„ì„`,\n      keywords: ['ì¹´í˜ ìš´ì˜ ë…¸í•˜ìš°', 'AI ìë™í™” í™œìš©', 'hovoo ì‹¤ë¬´ ê²½í—˜', 'ì´ë¯¸ì»¤í”¼ ì‹œìŠ¤í…œ', 'F&B ë¸Œëœë”©'],\n      category: 'AI ì‹¤ë¬´ í™œìš©',\n      readingTime: Math.ceil($('Enhanced Blog Generation').item.json.text.length / 1000),\n      contentQuality: 7,\n      metadata: {\n        processed_at: new Date().toISOString(),\n        source_channel: originalData.channelName,\n        video_id: originalData.videoId,\n        transcript_source: originalData.transcriptSource,\n        parsing_success: false,\n        parsing_error: error.message,\n        fallback_used: true\n      }\n    };\n  }\n}\n\nfunction generateSlug(title) {\n  return 'hovoo-' + \n    title.toLowerCase()\n    .replace(/[^a-z0-9ê°€-í£\\s-]/g, '')\n    .replace(/[ê°€-í£]/g, '')\n    .replace(/\\s+/g, '-')\n    .replace(/-+/g, '-')\n    .replace(/^-|-$/g, '')\n    .substring(0, 40) + \n    '-2408';\n}\n\nfunction cleanSlug(slug) {\n  return slug.toLowerCase()\n    .replace(/[^a-z0-9\\s-]/g, '')\n    .replace(/\\s+/g, '-')\n    .replace(/-+/g, '-')\n    .replace(/^-|-$/g, '')\n    .substring(0, 50);\n}\n\nreturn parseEnhancedJSON(rawText);"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2528, 224],
      "id": "enhanced-parse-seo-json",
      "name": "Enhanced Parse SEO JSON"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "251d0f53623d8158b023d994a1e58122",
          "mode": "id"
        },
        "title": "={{ $json.title }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "ì œëª©",
              "type": "title",
              "titleValue": "={{ $json.title }}"
            },
            {
              "key": "ë³¸ë¬¸",
              "type": "rich_text",
              "textContent": "={{ $('Enhanced Blog Generation').item.json.text }}"
            },
            {
              "key": "ì›ë³¸ ì˜ìƒ",
              "type": "url",
              "urlValue": "={{ $('Merge Transcript Data').item.json.youtubeUrl }}"
            },
            {
              "key": "ì±„ë„ëª…",
              "type": "rich_text",
              "textContent": "={{ $('Merge Transcript Data').item.json.channelName }}"
            },
            {
              "key": "URL ìŠ¬ëŸ¬ê·¸",
              "type": "rich_text",
              "textContent": "={{ $json.slug }}"
            },
            {
              "key": "ë©”íƒ€ ì„¤ëª…",
              "type": "rich_text",
              "textContent": "={{ $json.meta_description }}"
            },
            {
              "key": "íƒœê·¸",
              "type": "multi_select",
              "multiSelectValue": "={{ $json.tags }}"
            },
            {
              "key": "ì¹´í…Œê³ ë¦¬",
              "type": "select",
              "selectValue": "={{ $json.category }}"
            },
            {
              "key": "ìƒíƒœ",
              "type": "select",
              "selectValue": "ìƒì„±ì™„ë£Œ"
            },
            {
              "key": "ì‘ì„±ì¼",
              "type": "date",
              "date": "={{ $now }}"
            },
            {
              "key": "ì½ê¸°ì‹œê°„",
              "type": "number",
              "numberValue": "={{ $json.readingTime }}"
            },
            {
              "key": "í’ˆì§ˆì ìˆ˜",
              "type": "number",
              "numberValue": "={{ $json.contentQuality }}"
            },
            {
              "key": "ìë§‰ì†ŒìŠ¤",
              "type": "select",
              "selectValue": "={{ $('Merge Transcript Data').item.json.transcriptSource }}"
            },
            {
              "key": "ì²˜ë¦¬ì‹œê°„",
              "type": "rich_text",
              "textContent": "={{ Math.round(($now - new Date($('Enhanced Webhook Trigger').item.json.timestamp || Date.now())) / 1000) }}ì´ˆ"
            }
          ]
        },
        "options": {}
      },
      "id": "enhanced-save-blog-db",
      "name": "Enhanced Save to Blog DB",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [2736, 224],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Enhanced Webhook Trigger').item.json.body.chatId || '7830356405' }}",
        "text": "ğŸ‰ *YouTube ë¸”ë¡œê·¸ ìë™í™” ì™„ë£Œ!* (Enhanced)\n\nğŸ“ **ì œëª©**: {{ $json.title }}\nğŸ“Š **SEO ì ìˆ˜**: {{ $('Enhanced Parse SEO JSON').item.json.contentQuality }}/10\nğŸ“ˆ **ì½ê¸° ì‹œê°„**: {{ $('Enhanced Parse SEO JSON').item.json.readingTime }}ë¶„\nğŸ·ï¸ **íƒœê·¸**: {{ $('Enhanced Parse SEO JSON').item.json.tags.slice(0,5).join(', ') }}\nğŸ“ **ì¹´í…Œê³ ë¦¬**: {{ $('Enhanced Parse SEO JSON').item.json.category }}\n\nâœ… **ì²˜ë¦¬ ì™„ë£Œ í•­ëª©**:\nâ€¢ YouTube ì˜ìƒ ì •ë³´ ìˆ˜ì§‘ âœ“\nâ€¢ ìë§‰/ì „ì‚¬ ë‚´ìš© ì¶”ì¶œ ({{ $('Merge Transcript Data').item.json.transcriptSource }}) âœ“\nâ€¢ hovoo í˜ë¥´ì†Œë‚˜ ë¸”ë¡œê·¸ ê¸€ ìƒì„± ({{ $('Enhanced Blog Generation').item.json.text.length }}ì) âœ“\nâ€¢ SEO ë©”íƒ€ë°ì´í„° ìµœì í™” âœ“\nâ€¢ Notion ë¸”ë¡œê·¸ DB ì €ì¥ âœ“\n\nğŸ”— **ìŠ¬ëŸ¬ê·¸**: `{{ $('Enhanced Parse SEO JSON').item.json.slug }}`\nâš¡ **ì²˜ë¦¬ì‹œê°„**: {{ $('Enhanced Parse SEO JSON').item.json.metadata.processed_at ? Math.round((new Date($('Enhanced Parse SEO JSON').item.json.metadata.processed_at) - new Date($('Enhanced Webhook Trigger').item.json.timestamp || Date.now())) / 1000) : 'N/A' }}ì´ˆ\n\nğŸ’¡ **ë‹¤ìŒ ë‹¨ê³„**: Ghost ë¸”ë¡œê·¸ ìë™ ë°œí–‰ì„ ìœ„í•´ ë³„ë„ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.\n\n---\n*ì´ë¯¸ì»¤í”¼ AI ìë™í™” ì‹œìŠ¤í…œ Enhanced | hovoo*",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "enhanced-success-notification",
      "name": "Enhanced Success Notification",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [2944, 224],
      "webhookId": "enhanced-success-notification",
      "credentials": {
        "telegramApi": {
          "id": "hIo5i77YKdu9Rs8g",
          "name": "youtube imi Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Enhanced Webhook Trigger').item.json.body.chatId || '7830356405' }}",
        "text": "ğŸš¨ *YouTube ì •ë³´ ì¶”ì¶œ ì‹¤íŒ¨*\n\nâŒ **ì˜¤ë¥˜**: {{ $json.error }}\nğŸ“„ **í˜ì´ì§€ ID**: {{ $json.pageId }}\nğŸ¬ **ë¹„ë””ì˜¤ ID**: {{ $json.videoId }}\n\nğŸ” **ë””ë²„ê·¸ ì •ë³´**:\n{{ JSON.stringify($json.debugInfo, null, 2) }}\n\nğŸ› ï¸ **í•´ê²° ë°©ì•ˆ**:\n1. Notion í˜ì´ì§€ì˜ YouTube URL í•„ë“œ í™•ì¸\n2. ì˜ìƒ IDê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸\n3. ìˆ˜ë™ìœ¼ë¡œ ë‹¤ì‹œ ì‹œë„\n\n---\n*ì´ë¯¸ì»¤í”¼ AI ìë™í™” ì‹œìŠ¤í…œ Enhanced | Error Handler*",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "extraction-error-notification",
      "name": "Extraction Error Notification",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1280, 464],
      "webhookId": "extraction-error-notification",
      "credentials": {
        "telegramApi": {
          "id": "hIo5i77YKdu9Rs8g",
          "name": "youtube imi Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Validate and Respond').item.json.data?.chatId || '7830356405' }}",
        "text": "âŒ *ì…ë ¥ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨*\n\n**ì˜¤ë¥˜**: {{ $json.error }}\n**ìƒíƒœ ì½”ë“œ**: {{ $json.statusCode }}\n**ì‹œê°„**: {{ $json.timestamp }}\n\ní•„ìˆ˜ í•„ë“œ (pageId, videoId)ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "validation-error-notification",
      "name": "Validation Error Notification",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [656, 544],
      "webhookId": "validation-error-notification",
      "credentials": {
        "telegramApi": {
          "id": "hIo5i77YKdu9Rs8g",
          "name": "youtube imi Telegram account"
        }
      }
    }
  ],
  "connections": {
    "Enhanced Webhook Trigger": {
      "main": [
        [
          {
            "node": "Validate and Respond",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validate and Respond": {
      "main": [
        [
          {
            "node": "Immediate Webhook Response",
            "type": "main",
            "index": 0
          },
          {
            "node": "Check Validation Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Validation Success": {
      "main": [
        [
          {
            "node": "Get Notion Data Enhanced",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Validation Error Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Notion Data Enhanced": {
      "main": [
        [
          {
            "node": "Enhanced Extract Info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enhanced Extract Info": {
      "main": [
        [
          {
            "node": "Check Extraction Success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Extraction Success": {
      "main": [
        [
          {
            "node": "Check Cached Transcript",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extraction Error Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Cached Transcript": {
      "main": [
        [
          {
            "node": "Merge Transcript Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fetch Missing Transcript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Missing Transcript": {
      "main": [
        [
          {
            "node": "Merge Transcript Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Transcript Data": {
      "main": [
        [
          {
            "node": "Enhanced Blog Generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enhanced Blog Generation": {
      "main": [
        [
          {
            "node": "Enhanced SEO Optimization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Blog Model": {
      "ai_languageModel": [
        [
          {
            "node": "Enhanced Blog Generation",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Enhanced SEO Optimization": {
      "main": [
        [
          {
            "node": "Enhanced Parse SEO JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini SEO Model": {
      "ai_languageModel": [
        [
          {
            "node": "Enhanced SEO Optimization",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Enhanced Parse SEO JSON": {
      "main": [
        [
          {
            "node": "Enhanced Save to Blog DB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enhanced Save to Blog DB": {
      "main": [
        [
          {
            "node": "Enhanced Success Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "503b3d8b44115e5921e2e4e1edcde177dde00c303a77361802e2da13d7103e31"
  }
}