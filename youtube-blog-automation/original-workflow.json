{
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "youtube-to-blog",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "ce69223e-9c32-448e-b4a3-c7b3aba27b4f",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -592,
        1680
      ],
      "webhookId": "youtube-to-blog"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $json.body.pageId }}",
          "mode": "id"
        }
      },
      "id": "f276c64b-46f3-4e48-9a8e-6e767c3000d6",
      "name": "Get Video Info from Notion",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -384,
        1680
      ],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "youtubeId": "={{ $json.URL }}",
        "preferCapLang": "ko"
      },
      "id": "3ddf0959-6f42-4731-ae5f-54f630547983",
      "name": "Get YouTube Transcript",
      "type": "n8n-nodes-bandi-youtube-transcript.youtubeTranscriptNode",
      "typeVersion": 1,
      "position": [
        -192,
        1680
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=당신은 한국어 블로그 글 작성 전문가입니다.\nYouTube 영상 자막을 바탕으로 완전한 블로그 글을 작성하세요.\n\n[영상 정보]\n제목: {{ $('Get Video Info from Notion').item.json.title }}\n채널: {{ $('Get Video Info from Notion').item.json['채널명'] }}\nURL: {{ $('Get Video Info from Notion').item.json.URL }}\n\n[자막 전문]\n{{ $json.transcript }}\n\n[작성 요구사항]\n1. 영상 내용을 빠짐없이 담은 완전한 글\n2. 구체적인 예시와 숫자 포함\n3. 자연스러운 한국어 문체\n4. H1 제목 하나, H2/H3 소제목으로 구조화\n5. 최소 2000자 이상\n6. 마크다운 형식\n\n[글 구조]\n- 도입: 주제 소개와 핵심 가치\n- 본문: 영상의 주요 내용을 논리적으로 전개\n- 실전 팁: 구체적인 실행 방법\n- 결론: 핵심 메시지와 행동 유도",
        "batching": {}
      },
      "id": "ea198241-3d4b-4bf1-9a9f-3f682788b752",
      "name": "Create Blog Article1",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        16,
        1680
      ]
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {
          "maxOutputTokens": 3000,
          "temperature": 0.5
        }
      },
      "id": "6a7c28ca-b5ad-4f35-af3b-493d12d62ac2",
      "name": "Gemini for Article1",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        128,
        1904
      ],
      "credentials": {
        "googlePalmApi": {
          "id": "SO4eLSfcE2Z5kkss",
          "name": "hovoo Google Gemini Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=당신은 SEO 전문가입니다.\n제공된 블로그 글을 최적화하고 메타데이터를 생성하세요.\n\n[원본 글]\n{{ $json.text }}\n\n[영상 정보]\n제목: {{ $('Get Video Info from Notion').item.json.title }}\nURL: {{ $('Get Video Info from Notion').item.json.URL }}\n\n**반드시 아래 JSON 형식으로만 출력:**\n\n```json\n{\n  \"title\": \"클릭하고 싶은 매력적인 제목 (60자 이내)\",\n  \"body\": \"SEO 최적화된 블로그 본문 (마크다운)\",\n  \"slug\": \"url-friendly-slug\",\n  \"tags\": [\"태그1\", \"태그2\", \"태그3\", \"태그4\", \"태그5\"]\n}\n```\n\n최적화 원칙:\n- 제목은 호기심을 자극하면서도 명확해야 함\n- 본문 첫 단락에 핵심 키워드 포함\n- 스캔하기 쉬운 구조 (짧은 단락, 불릿 포인트)\n- URL 슬러그는 영문 소문자와 하이픈만 사용\n- 태그는 5-7개",
        "batching": {}
      },
      "id": "5a766d0f-8ec1-4149-a2ec-7ae8480a75cb",
      "name": "SEO Optimization1",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        384,
        1680
      ]
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {
          "maxOutputTokens": 3500,
          "temperature": 0.3
        }
      },
      "id": "4bce31bf-7ae3-4c6b-97eb-83c9480ffaca",
      "name": "Gemini for SEO1",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        480,
        1920
      ],
      "credentials": {
        "googlePalmApi": {
          "id": "SO4eLSfcE2Z5kkss",
          "name": "hovoo Google Gemini Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// JSON 파싱\nconst rawText = $input.first().json.text;\nlet jsonText = rawText;\n\n// JSON 추출\nif (rawText.includes('```json')) {\n  const start = rawText.indexOf('```json') + 7;\n  const end = rawText.lastIndexOf('```');\n  jsonText = rawText.substring(start, end).trim();\n}\n\ntry {\n  const data = JSON.parse(jsonText);\n  \n  // 원본 정보 추가\n  const notionData = $('Get Video Info from Notion').item.json;\n  \n  return {\n    // 블로그 데이터\n    title: data.title || notionData.title.substring(0, 60),\n    body: data.body || $('Create Blog Article1').item.json.text,\n    slug: data.slug || 'blog-post',\n    tags: data.tags || ['YouTube', '블로그'],\n    \n    // 원본 정보\n    video_url: notionData.URL,\n    channel_name: notionData['채널명'],\n    original_title: notionData.title,\n    \n    // 메타 정보\n    status: '초안',\n    created_at: new Date().toISOString()\n  };\n  \n} catch (error) {\n  // 파싱 실패 시 기본값\n  const notionData = $('Get Video Info from Notion').item.json;\n  \n  return {\n    title: notionData.title,\n    body: $('Create Blog Article1').item.json.text,\n    slug: 'blog-post-' + Date.now(),\n    tags: ['YouTube', '블로그'],\n    video_url: notionData.URL,\n    channel_name: notionData['채널명'],\n    original_title: notionData.title,\n    status: '초안',\n    created_at: new Date().toISOString(),\n    error: error.message\n  };\n}"
      },
      "id": "60c46622-fe91-4c58-9ac7-d121c6da692d",
      "name": "Parse JSON",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        768,
        1680
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "251d0f53623d8158b023d994a1e58122",
          "mode": "id"
        },
        "title": "={{ $json.title }}",
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "원본 영상|url",
              "urlValue": "={{ $json.video_url }}"
            },
            {
              "key": "채널명|rich_text",
              "textContent": "={{ $json.channel_name }}"
            },
            {
              "key": "본문|rich_text",
              "textContent": "={{ $json.body }}"
            },
            {
              "key": "URL 슬러그|rich_text",
              "textContent": "={{ $json.slug }}"
            },
            {
              "key": "태그|multi_select",
              "multiSelectValue": "={{ $json.tags }}"
            },
            {
              "key": "상태|select",
              "selectValue": "={{ $json.status }}"
            },
            {
              "key": "작성일|date",
              "date": "={{ $now }}"
            }
          ]
        },
        "options": {}
      },
      "id": "a5ec7940-23c3-4e46-a1ae-513ae6af9219",
      "name": "Save to Blog DB",
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        960,
        1680
      ],
      "credentials": {
        "notionApi": {
          "id": "kCKFfrau35Gf4PvW",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json.body.chatId || '7830356405' }}",
        "text": "=✅ 블로그 글 생성 완료!\n\n📝 제목: {{ $('Parse JSON').item.json.title }}\n🔗 슬러그: {{ $('Parse JSON').item.json.slug }}\n🏷 태그: {{ $('Parse JSON').item.json.tags.join(', ') }}\n\n💾 Notion에 저장되었습니다.\n\n원본: {{ $('Parse JSON').item.json.video_url }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "id": "0791db12-14ec-4d3e-90e0-c34a8fb4c831",
      "name": "Send Success Message",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1168,
        1680
      ],
      "webhookId": "telegram-webhook",
      "credentials": {
        "telegramApi": {
          "id": "hIo5i77YKdu9Rs8g",
          "name": "youtube imi Telegram account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "545f7bbf-2c7d-463f-b958-39d6f3d0292e",
      "name": "Webhook Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1360,
        1680
      ]
    }
  ],
  "connections": {
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Get Video Info from Notion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Video Info from Notion": {
      "main": [
        [
          {
            "node": "Get YouTube Transcript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get YouTube Transcript": {
      "main": [
        [
          {
            "node": "Create Blog Article1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse JSON": {
      "main": [
        [
          {
            "node": "Save to Blog DB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save to Blog DB": {
      "main": [
        [
          {
            "node": "Send Success Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Success Message": {
      "main": [
        [
          {
            "node": "Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Blog Article1": {
      "main": [
        [
          {
            "node": "SEO Optimization1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini for Article1": {
      "ai_languageModel": [
        [
          {
            "node": "Create Blog Article1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "SEO Optimization1": {
      "main": [
        [
          {
            "node": "Parse JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini for SEO1": {
      "ai_languageModel": [
        [
          {
            "node": "SEO Optimization1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "503b3d8b44115e5921e2e4e1edcde177dde00c303a77361802e2da13d7103e31"
  }
}